<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户留言 - 广州特色</title>
    
    <!-- 引入外部资源 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-router@3.5.3/dist/vue-router.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuex@3.6.2/dist/vuex.js"></script>
    
    <!-- 引入Vuex Store和Router -->
    <script src="js/store.js"></script>
    <script src="js/router.js"></script>
  <!-- 主JavaScript文件将移到页面底部 -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <!-- 引入自定义样式 -->
  <link rel="stylesheet" href="css/style.css">

  <!-- 配置Tailwind自定义主题 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#D4AF37',
            secondary: '#006400',
            accent: '#8B0000',
            light: '#F5F7FA',
            dark: '#1D2129',
          },
          fontFamily: {
            inter: ['Inter', 'sans-serif'],
          },
        },
      }
    }
  </script>


</head>

<body>
  <div id="app">
    <!-- 导航栏 -->
    <navbar></navbar>

  <!-- 主内容区 -->
  <main class="pt-24 pb-12 bg-gradient-to-b from-secondary/10 to-white">
    <div class="container mx-auto px-4">
      <div class="text-center mb-16">
        <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold text-secondary mb-4">广州旅游留言讨论</h1>
        <p class="text-gray-600 max-w-3xl mx-auto text-lg">在这里分享你对广州旅游各个方面的看法和经验，参与精彩的讨论。</p>
      </div>

      <!-- 话题列表 -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          <!-- 话题卡片示例 -->
          <div class="bg-white rounded-lg shadow-md overflow-hidden transition-all duration-300 hover:shadow-lg">
            <div class="p-6">
              <h3 class="text-xl font-bold text-secondary mb-3">广州美食体验</h3>
              <p class="text-gray-600 mb-4">分享你在广州品尝到的美食，推荐好吃的餐厅和特色菜品。</p>
              <a href="discussion-gastronomy.html" class="text-primary hover:text-accent transition-colors">
                参与讨论 <i class="fa fa-arrow-right ml-1"></i>
              </a>
            </div>
          </div>
          <div class="bg-white rounded-lg shadow-md overflow-hidden transition-all duration-300 hover:shadow-lg">
            <div class="p-6">
              <h3 class="text-xl font-bold text-secondary mb-3">热门景点打卡</h3>
              <p class="text-gray-600 mb-4">谈谈你去过的广州景点，分享游玩攻略和精彩瞬间。</p>
              <a href="discussion-attractions.html" class="text-primary hover:text-accent transition-colors">
                参与讨论 <i class="fa fa-arrow-right ml-1"></i>
              </a>
            </div>
          </div>
          <div class="bg-white rounded-lg shadow-md overflow-hidden transition-all duration-300 hover:shadow-lg">
            <div class="p-6">
              <h3 class="text-xl font-bold text-secondary mb-3">岭南文化探索</h3>
              <p class="text-gray-600 mb-4">交流你对岭南文化的理解和感悟，分享相关的文化活动和体验。</p>
              <a href="discussion-culture.html" class="text-primary hover:text-accent transition-colors">
                参与讨论 <i class="fa fa-arrow-right ml-1"></i>
              </a>
            </div>
          </div>
        </div>

      <!-- 留言表单 -->
      <div class="bg-white rounded-xl p-8 shadow-md">
        <h3 class="text-xl font-bold text-secondary mb-6">发表留言</h3>
        <form id="feedbackForm" class="space-y-4">
          <div>
            <label for="content" class="block text-sm font-medium text-gray-700 mb-1">留言内容</label>
            <textarea 
              id="content" 
              v-model="feedback.content" 
              class="form-input" 
              rows="4" 
              placeholder="分享你的广州旅游体验..."></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">评分</label>
            <div class="flex items-center space-x-1">
              <span v-for="i in 5" :key="i" 
                    class="text-2xl cursor-pointer" 
                    :class="feedback.rating >= i ? 'text-yellow-400' : 'text-gray-300'"
                    @click="feedback.rating = i">
                <i class="fa fa-star"></i>
              </span>
            </div>
          </div>
          <!-- 错误提示 -->
          <div v-if="feedback.errors && feedback.errors.general" class="text-red-500 text-sm mb-2">
            {{ feedback.errors.general }}
          </div>
          <button 
            type="submit" 
            @click.prevent="submitFeedback" 
            class="btn-primary" 
            :disabled="feedback.isSubmitting">
            <span v-if="feedback.isSubmitting"><i class="fa fa-spinner fa-spin mr-1"></i> 提交中...</span>
            <span v-else>提交留言</span>
          </button>
        </form>
      </div>
      
      <!-- 留言列表 -->
      <div class="bg-white rounded-xl p-8 shadow-md mt-12">
        <h3 class="text-xl font-bold text-secondary mb-6">精选留言</h3>
        <div id="feedbackList" class="space-y-6">
          <!-- 没有留言时的提示 -->
          <div v-if="$store.state.feedbacks.length === 0" class="text-center py-16 bg-secondary/5 rounded-lg">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-primary/10 rounded-full mb-4">
              <i class="fa fa-comments text-3xl text-primary"></i>
            </div>
            <h4 class="text-xl font-semibold text-secondary mb-2">还没有留言</h4>
            <p class="text-gray-600 max-w-md mx-auto mb-6">成为第一个分享广州旅游体验的人吧！</p>
            <button @click="scrollToFeedbackForm" class="btn-primary">
              发表第一条留言
            </button>
          </div>
          
          <!-- 留言列表 -->
          <div v-for="feedback in $store.state.feedbacks" :key="feedback.id" class="border-b border-gray-100 pb-4 last:border-b-0 last:pb-0">
            <div class="flex items-center mb-3">
              <img :src="feedback.avatar" :alt="feedback.name" class="w-12 h-12 rounded-full object-cover mr-4">
              <div>
                <h4 class="font-semibold text-gray-800">{{ feedback.name }}</h4>
                <div class="flex items-center text-sm text-gray-500 mt-1">
                  <i class="fa fa-clock-o mr-1"></i>
                  <span>{{ feedback.date }}</span>
                </div>
              </div>
            </div>
            <p class="text-gray-600 mb-3">{{ feedback.content }}</p>
            <!-- 评分显示 -->
            <div class="flex items-center mb-3">
              <div class="flex items-center space-x-1">
                <span v-for="i in 5" :key="i" 
                      class="text-2xl"
                      :class="feedback.rating >= i ? 'text-yellow-400' : 'text-gray-300'">
                  <i class="fa fa-star"></i>
                </span>
              </div>
              <span class="ml-2 text-sm text-gray-500">{{ feedback.rating }}/5</span>
            </div>
            <div class="flex items-center text-sm text-gray-500">
              <button class="flex items-center hover:text-primary transition-colors mr-6" @click="likeFeedback(feedback.id)">
                <i class="fa fa-heart-o mr-1"></i>
                <span>{{ feedback.likes || 0 }}</span>
              </button>
              <button class="flex items-center hover:text-primary transition-colors">
                <i class="fa fa-comment-o mr-1"></i>
                <span>{{ feedback.replies || 0 }}</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>



  <!-- 登录模态框 -->
  <div id="loginModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 bg-blur hidden"
       :class="{ 'hidden': !loginModalVisible }">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md p-8 transform transition-all duration-300"
         :class="{ 'opacity-0 scale-95': !modalReady, 'opacity-100 scale-100': modalReady }">
      <div class="text-center mb-6">
        <h3 class="text-2xl font-bold text-secondary">用户登录</h3>
        <p class="text-gray-500">请输入您的账号和密码</p>
      </div>

      <form class="space-y-4">
        <div>
          <label for="loginEmail" class="block text-sm font-medium text-gray-700 mb-1">邮箱</label>
          <input 
            type="email" 
            id="loginEmail" 
            v-model="login.email" 
            @blur="validateLoginField('email')" 
            class="form-input" 
            placeholder="your@email.com">
          <p class="text-red-500 text-sm mt-1" v-if="login.errors.email">
            {{ login.errors.email }}
          </p>
        </div>
        <div>
          <label for="loginPassword" class="block text-sm font-medium text-gray-700 mb-1">密码</label>
          <input 
            type="password" 
            id="loginPassword" 
            v-model="login.password" 
            @blur="validateLoginField('password')" 
            class="form-input" 
            placeholder="请输入密码">
          <p class="text-red-500 text-sm mt-1" v-if="login.errors.password">
            {{ login.errors.password }}
          </p>
        </div>
        <div class="flex justify-between items-center">
          <div class="flex items-center">
            <input type="checkbox" id="rememberMe" class="mr-2">
            <label for="rememberMe" class="text-sm text-gray-700">记住我</label>
          </div>
          <a href="#" class="text-sm text-primary hover:text-accent">忘记密码?</a>
        </div>
        <button type="submit" class="btn-primary w-full">登录</button>
      </form>

      <div class="text-center text-sm text-gray-600">
        还没有账号? <a href="#" class="text-primary hover:text-accent">立即注册</a>
      </div>

      <button 
        type="button" 
        class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"
        @click="closeLoginModal">
        <i class="fa fa-times text-xl"></i>
      </button>
    </div>
  </div>

  <footer-component></footer-component>
  </div>

  <!-- Vue实例已经在main.js中初始化 -->
  <script>
    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', () => {
      // 确保Vue实例已经加载
      if (window.app) {
        // 加载留言数据
        window.app.$store.dispatch('loadFeedbacks');
        // 初始化暗黑模式状态
        const darkMode = localStorage.getItem('darkMode') === 'true';
        document.documentElement.classList.toggle('dark', darkMode);
        // 更新Navbar组件的暗黑模式状态
        const navbar = window.app.$children.find(child => child.$el.tagName.toLowerCase() === 'navbar');
        if (navbar) {
          navbar.darkMode = darkMode;
          navbar.updateDarkModeUI();
        }
      }
    });
  </script>
  <!-- 引入主JavaScript文件 -->
  <script src="js/main.js"></script>
</body>

</html>